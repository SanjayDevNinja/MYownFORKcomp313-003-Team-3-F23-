<%- include partials/navbar.ejs %>
    <!-- change all time git -->
    <!-- how to git https://stackoverflow.com/questions/1221840/remote-origin-already-exists-on-git-push-to-a-new-repository -->

  <!-- Main Content -->
  <div class="main">
  
  <main class="container">
    <h2>Available Books</h2>
      <!-- copy from booklist, need clean up code -->
    <div class="jumbotron">
      <h1 class="display-4">Book listing</h1>
      <br/>
      <a href="/admin/create-book" class="btn btn-success " style="font-size: 1.3em;"><i  class="bi bi-database-add"></i> Create New Book Record</a>
      <br/><br/>
      <div style="display: flex">
        <table id="bookTable">
          <tr>
          <td style="min-width: 100px">ID</td>
          <td style="min-width: 100px">ISBN</td>
          <td style="min-width: 100px">Book name</td>
          <td style="min-width: 100px">Author Name</td>
          <td style="min-width: 100px">Availability</td>
        </tr>
          <tr>
            <td>loading....</td>
          </tr>
        </table>
      </div>
    </div>
  </main>
</div>



<script>
  async function fetchAllBooks(){
    try {
        let res = await fetch('/books/v1/getall')
        let answer = await res.json()
        //console.log(answer)
        let htmlAttachment = `<tr>
              <td style="min-width:200px;">
                id
              </td>
              <td style="min-width:200px;">
                Title
              </td>
            </tr>`
        //console.log(answer)
        answer.forEach(item => {
            let htmlSegment = `
            <tr>
                <td>
                    ${item.id}
                </td>
                <td>
                    ${item.name}
                </td>
            </tr>
            `
            htmlAttachment = htmlAttachment + htmlSegment
        })


        document.getElementById("bookTable").innerHTML = htmlAttachment
    } catch (err) {
        console.log(err)
    }

}

fetchAllBooks()
</script>
  
<%- include partials/footer.ejs %>
  




